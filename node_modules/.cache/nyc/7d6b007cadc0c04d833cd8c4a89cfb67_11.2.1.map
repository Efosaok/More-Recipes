{"version":3,"sources":["auth.js"],"names":["secret","process","env","SECRET","verifyToken","req","res","next","token","headers","auth","verify","err","decoded","status","send","error"],"mappings":";;;;;;AAAA;;;;;;AAEA,IAAMA,SAASC,QAAQC,GAAR,CAAYC,MAA3B;;AAEA,IAAMC,cAAc,SAAdA,WAAc,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACtC,MAAMC,QAAQH,IAAII,OAAJ,CAAYC,IAAZ,IAAoBL,IAAII,OAAJ,CAAY,gBAAZ,CAAlC;AACA,MAAID,KAAJ,EAAW;AACT,2BAAIG,MAAJ,CAAWH,KAAX,EAAkBR,MAAlB,EAA0B,UAACY,GAAD,EAAMC,OAAN,EAAkB;AAC1C,UAAID,GAAJ,EAAS;AACP,eAAON,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,eAAT,EAArB,CAAP;AACD,OAFD,MAEO;AACLX,YAAIQ,OAAJ,GAAcA,OAAd;AACAN;AACD;AACF,KAPD;AAQD,GATD,MASO;AACL,WAAOD,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,gBAAT,EAArB,CAAP;AACD;AACF,CAdD;;kBAgBeZ,W","file":"auth.js","sourceRoot":"C:/Users/efosa/Documents/More-Recipes/Server/middlewares","sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nconst secret = process.env.SECRET;\r\n\r\nconst verifyToken = (req, res, next) => {\r\n  const token = req.headers.auth || req.headers['x-access-token'];\r\n  if (token) {\r\n    jwt.verify(token, secret, (err, decoded) => {\r\n      if (err) {\r\n        return res.status(400).send({ error: 'Invalid token' });\r\n      } else {\r\n        req.decoded = decoded;\r\n        next();\r\n      }\r\n    });\r\n  } else {\r\n    return res.status(403).send({ error: 'No token found' });\r\n  }\r\n};\r\n\r\nexport default verifyToken;\r\n"]}